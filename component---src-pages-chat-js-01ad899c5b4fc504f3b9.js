(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"6Rr0":function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("otPn"),i=n("XDYV"),c=function(e){var t=e.right,n=e.message;return a.a.createElement(o.a,{pad:"small",fill:!0,direction:"row"},a.a.createElement(o.a,{overflow:"visible",flex:{shrink:0},fill:!1,round:"8px",pad:"small",border:"4px",background:"brand",margin:{left:t?"auto":"0"}},a.a.createElement(i.a,null,n.senderName),a.a.createElement("br",null),n.message,n.isThirdPerson))},u=n("P3Am"),l=n("jCe7");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f=function(e){return a.a.createElement(l.a,s({viewBox:"0 0 24 24",a11yTitle:"Send"},e),a.a.createElement("path",{fill:"none",stroke:"#000",strokeWidth:"2",d:"M22,3 L2,11 L20.5,19 L22,3 Z M10,20.5 L13,16 M15.5,9.5 L9,14 L9.85884537,20.0119176 C9.93680292,20.5576204 10.0751625,20.5490248 10.1651297,20.009222 L11,15 L15.5,9.5 Z"}))},m=function(e){var t=e.onSubmit,n=e.placeholder,i=Object(r.useState)(""),c=i[0],l=i[1];return a.a.createElement(o.a,null,a.a.createElement(u.a,{placeholder:n,icon:a.a.createElement(f,{style:{cursor:"pointer"}}),reverse:!0,value:c,onKeyPress:function(e){"Enter"===e.key&&(t&&t(c),l(""))},onChange:function(e){l(e.target.value)}}))},d=function(e){var t=e.messages,n=e.onSendMessage,i=(e.roleProfiles,Object(r.useRef)(null));return Object(r.useEffect)((function(){i&&i.current.scrollTo(0,i.current.scrollHeight)}),[t]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{ref:i,style:{borderRadius:"4px",border:"1px solid gray",overflow:"scroll",height:"calc(100% - 35px)"}},a.a.createElement(o.a,null,a.a.createElement(o.a,null,t&&t.map((function(e,t){return a.a.createElement(c,{message:e})}))))),a.a.createElement(m,{placeholder:"type to ask question",onSubmit:n}))},p=n("ACV0"),g=n("LXcg"),b=n("ECLh");t.a=function(e){var t=e.publicRoom,n=e.senderRoleName,o=e.recipientRoleName,i=e.chatroomName,c=t?o:[n,o].sort().join("_"),u=Object(r.useState)([]),l=u[0],s=u[1],f=Object(r.useState)(null),m=f[0],h=f[1],v=function(e){return e.map((function(e){return{message:e.message,senderName:e.name,isThirdPerson:e.role!==n}}))};return Object(r.useEffect)((function(){Object(g.i)(c).then((function(e){s(v(e))}))}),[c]),Object(r.useEffect)((function(){m&&Object(g.i)(c).then((function(e){s(v(e))}))}),[m]),a.a.createElement(a.a.Fragment,null,i&&a.a.createElement(p.a,{level:3}," ",i," "),a.a.createElement(d,{onSendMessage:function(e){Object(g.t)(n,t,e,o)},messages:l}),a.a.createElement(b.a,{objectClass:"ChatroomMessage",onEvent:function(e,t){"create"===t&&h(e)}}))}},ECLh:function(e,t,n){"use strict";var r,a=n("dI71"),o=n("q1tI"),i=n.n(o),c=n("LXcg");r||(r=new c.e.LiveQueryClient({applicationId:"32hrI9O4UWscR1vOtkNt62eoLtZgyS9SUIEwp0HL",serverURL:"wss://bidbid.b4a.io",javascriptKey:"tnEpnIhi6dUdW3IcBxWcOegn6UvrcM1dIk6VfK5w",sessionToken:c.e.User.current()?c.e.User.current().getSessionToken():void 0})).open();var u=r,l=function(e){function t(){return e.apply(this,arguments)||this}Object(a.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.onEvent,n=e.objectClass;if(n){var r=new c.e.Query(n);r.ascending("createdAt").limit(5);var a=u.subscribe(r);a.on("create",(function(e){return t&&t(e,"create")})),a.on("update",(function(e){return t&&t(e,"update")})),a.on("delete",(function(e){return t&&t(e,"delete")}))}},n.componentWillUnmount=function(){u.close()},n.render=function(){return i.a.createElement(i.a.Fragment,null)},t}(i.a.Component);t.a=l},IcFT:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("q1tI"),a=n.n(r),o=n("vOnD"),i=n("otPn"),c=n("ou28"),u=n("4LIN"),l=n("XDYV"),s=n("/Rk8"),f=n("eaSK");function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var d=o.default.ul.withConfig({displayName:"List__StyledList",componentId:"sc-130gdqg-0"})(["list-style:none;"," padding:0;"," &:focus{","}","}","}"],(function(e){return!e.margin&&"margin: 0;"}),s.f,(function(e){return e.tabIndex>=0&&Object(s.e)({forceOutline:!0,skipSvgChildren:!0})}),(function(e){return e.itemFocus&&Object(s.e)({forceOutline:!0,skipSvgChildren:!0})}),(function(e){return e.theme.list&&e.theme.list.extend})),p=Object(o.default)(i.a).withConfig({displayName:"List__StyledItem",componentId:"sc-130gdqg-1"})([""," &:focus{","}",""],(function(e){return e.onClick&&"cursor: pointer;"}),Object(s.n)({forceOutline:!0,skipSvgChildren:!0}),(function(e){return e.theme.list&&e.theme.list.item&&e.theme.list.item.extend})),g=function(e,t,n){return"function"==typeof n?n(e,t):e[n]},b=a.a.forwardRef((function(e,t){var n=e.action,s=e.as,b=e.background,h=e.border,v=e.children,y=e.data,w=(e.focus,e.itemProps),j=e.pad,O=e.primaryKey,E=e.secondaryKey,x=e.step,k=e.onClickItem,S=e.onMore,C=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["action","as","background","border","children","data","focus","itemProps","pad","primaryKey","secondaryKey","step","onClickItem","onMore"]),A=Object(f.a)(t),P=Object(r.useContext)(o.ThemeContext),I=Object(r.useState)(),N=I[0],R=I[1],L=Object(r.useState)(),z=L[0],M=L[1];return a.a.createElement(u.a,{onEnter:k&&N>=0?function(e){e.persist();var t=e;t.item=y[N],t.index=N,k(t)}:void 0,onUp:k&&N?function(){R(N-1)}:void 0,onDown:k&&y&&y.length?function(){R(N>=0?Math.min(N+1,y.length-1):0)}:void 0},a.a.createElement(d,m({ref:A,as:s||"ul",itemFocus:z,tabIndex:k?0:void 0},C),a.a.createElement(c.a,{items:y,onMore:S,scrollableAncestor:"window",step:x,renderMarker:function(e){return a.a.createElement(i.a,{as:"li",flex:!1},e)}},(function(e,t){var r,o={};v?r=v(e,t,k?{active:N===t}:void 0):O?(r="function"==typeof O?O(e,t):a.a.createElement(l.a,{key:"p",weight:"bold"},g(e,t,O)),E&&(r="function"==typeof E?[r,E(e,t)]:[r,a.a.createElement(l.a,{key:"s"},g(e,t,E))],o={direction:"row",align:"center",justify:"between",gap:"medium"})):r="object"==typeof e?e[Object.keys(e)[0]]:e,n&&(r=[a.a.createElement(i.a,{align:"start",key:"actionContainer"+t},r),n(e,t)],o={direction:"row",align:E?"start":"center",justify:"between",gap:"medium"});var c=b||P.list.item.background;N===t?c=P.global.hover.background:Array.isArray(c)&&(c=c[t%c.length]);var u,s=void 0!==h?h:P.list.item.border;return"horizontal"===s&&t&&(s="bottom"),w&&w[t]&&(o=m({},o,w[t])),k&&(u={tabIndex:-1,active:N===t,onClick:function(n){n.persist();var r=n;r.item=e,r.index=t,k(r),A.current.focus()},onMouseOver:function(){return R(t)},onMouseOut:function(){return R(void 0)},onFocus:function(){R(t),M(!0)},onBlur:function(){R(void 0),M(!1)}}),a.a.createElement(p,m({key:t,tag:"li",flex:!1,pad:j||P.list.item.pad,background:c,border:s},o,u),r)}))))}));b.displayName="List";var h=b},QQwb:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),o=n("YwZP"),i=n("vOnD"),c=n("/Rk8"),u=n("18Yj"),l=n("+Wdg"),s={center:"center",end:"flex-end",start:"flex-start",stretch:"stretch"},f=Object(i.css)(["align-items:",";"],(function(e){return s[e.align]})),m={around:"space-around",between:"space-between",center:"center",end:"flex-end",start:"flex-start",stretch:"stretch"},d=Object(i.css)(["align-content:",";"],(function(e){return m[e.alignContent]})),p={center:"center",end:"flex-end",start:"flex-start",stretch:"stretch"},g=Object(i.css)(["justify-items:",";"],(function(e){return p[e.justify]})),b={around:"space-around",between:"space-between",center:"center",end:"flex-end",start:"flex-start",stretch:"stretch"},h=Object(i.css)(["justify-content:",";"],(function(e){return b[e.justifyContent]})),v={flex:"1fr",full:"100%","1/2":"50%","1/4":"25%","2/4":"50%","3/4":"75%","1/3":"33.33%","2/3":"66.66%"},y=function(e,t){return Array.isArray(e)?"minmax("+(t.global.size[e[0]]||e[0])+", "+(t.global.size[e[1]]||e[1])+")":"flex"===e?"1fr":"minmax("+(t.global.size[e]||e)+", 1fr)"},w=function(e,t,n){var r=v[e];return!n||!r||t.fillContainer&&"horizontal"!==t.fillContainer||console.warn("Grid needs `fill` when using fractional row sizes"),r||t.theme.global.size[e]||e},j=i.default.div.attrs((function(e){return{"aria-label":e.a11yTitleProp}})).withConfig({displayName:"StyledGrid",componentId:"sc-1wofa1l-0"})(["display:grid;box-sizing:border-box;"," "," "," "," "," "," "," "," "," "," "," "," ",""],c.f,(function(e){return e.border&&(Array.isArray(e.border)?e.border.map((function(t){return Object(u.a)(t,e.responsive,e.theme)})):Object(u.a)(e.border,e.responsive,e.theme))}),(function(e){return(t=e.fillContainer)?"horizontal"===t?"width: 100%;":"vertical"===t?"height: 100%;":"\n      width: 100%;\n      height: 100%;\n    ":t;var t}),(function(e){return e.align&&f}),(function(e){return e.alignContent&&d}),(function(e){return e.areas&&function(e){if(Array.isArray(e.rowsProp)&&Array.isArray(e.columns)||console.warn("Grid `areas` requires `rows` and `columns` to be arrays."),Array.isArray(e.areas)&&e.areas.every((function(e){return Array.isArray(e)})))return"grid-template-areas: "+e.areas.map((function(e){return'"'+e.join(" ")+'"'})).join(" ")+";";var t=e.rowsProp.map((function(){return e.columns.map((function(){return"."}))}));return e.areas.forEach((function(e){for(var n=e.start[1];n<=e.end[1];n+=1)for(var r=e.start[0];r<=e.end[0];r+=1)t[n][r]=e.name})),"grid-template-areas: "+t.map((function(e){return'"'+e.join(" ")+'"'})).join(" ")+";"}(e)}),(function(e){return e.columns&&function(e){return Array.isArray(e.columns)?Object(i.css)(["grid-template-columns:",";"],e.columns.map((function(t){return Array.isArray(t)?"minmax("+w(t[0],e)+", "+w(t[1],e)+")":w(t,e)})).join(" ")):"object"==typeof e.columns?Object(i.css)(["grid-template-columns:repeat( ",","," );"],"number"==typeof(t=e.columns.count)?t:"auto-"+t,y(e.columns.size,e.theme)):Object(i.css)(["grid-template-columns:repeat( auto-fill,"," );"],y(e.columns,e.theme));var t}(e)}),(function(e){return e.gap&&function(e){if("string"==typeof e.gap){var t=e.theme.global.edgeSize[e.gap]||e.gap;return"grid-gap: "+t+" "+t+";"}return e.gap.row&&e.gap.column?"\n      grid-row-gap: "+(e.theme.global.edgeSize[e.gap.row]||e.gap.row)+";\n      grid-column-gap: "+(e.theme.global.edgeSize[e.gap.column]||e.gap.column)+";\n    ":e.gap.row?"\n      grid-row-gap: "+(e.theme.global.edgeSize[e.gap.row]||e.gap.row)+";\n    ":e.gap.column?"\n      grid-column-gap: "+(e.theme.global.edgeSize[e.gap.column]||e.gap.column)+";\n    ":""}(e)}),(function(e){return e.justify&&g}),(function(e){return e.justifyContent&&h}),(function(e){return e.pad&&Object(c.c)("padding",e.pad,e.responsive,e.theme.global.edgeSize.responsiveBreakpoint,e.theme)}),(function(e){return e.rowsProp&&function(e){return Array.isArray(e.rowsProp)?Object(i.css)(["grid-template-rows:",";"],e.rowsProp.map((function(t){return Array.isArray(t)?"minmax("+w(t[0],e,!0)+", "+w(t[1],e,!0)+")":w(t,e,!0)})).join(" ")):Object(i.css)(["grid-auto-rows:",";"],e.theme.global.size[e.rowsProp])}(e)}),(function(e){return e.theme.grid&&e.theme.grid.extend}));function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}j.defaultProps={},Object.setPrototypeOf(j.defaultProps,l.a);var E=Object(r.forwardRef)((function(e,t){var n=e.a11yTitle,r=e.border,o=e.fill,i=e.responsive,c=void 0===i||i,u=e.rows,l=e.tag,s=e.as,f=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["a11yTitle","border","fill","responsive","rows","tag","as"]);return a.a.createElement(j,O({ref:t,a11yTitleProp:n,as:!s&&l?l:s,border:r,fillContainer:o,responsive:c,rowsProp:u},f))}));E.displayName="Grid";var x=E;x.available="undefined"!=typeof window&&window.CSS&&window.CSS.supports&&window.CSS.supports("display","grid");var k=n("otPn"),S=n("6Rr0"),C=n("LXcg"),A=n("o0o1"),P=n.n(A),I=(n("ls82"),n("HaE+")),N=n("IcFT"),R=n("463D"),L=function(e){var t=e.initialActiveId,n=e.senderRoleName,o=Object(r.useState)([]),i=o[0],c=o[1],u=Object(r.useState)(t||0)[0],l=Object(r.useState)({}),s=l[0],f=l[1];return Object(r.useEffect)((function(){(function(){var e=Object(I.a)(P.a.mark((function e(){var t,r,a,o;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.h)(n);case 2:return t=e.sent,c(t),r=t.reduce((function(e,t){return e.concat(t.get("uniqueName").split("_"))}),[]),e.next=7,Object(C.q)(r);case 7:a=e.sent,o=t.reduce((function(e,t){var r=t.get("uniqueName").split("_").filter((function(e){return e!==n}));return e[t.id]=r.map((function(e){var t=a.find((function(t){return t.role&&t.role.get("name")===e}));return t?t.rolePublicProfile.get("name"):""})).join(" "),e}),{}),f(o);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[n]),a.a.createElement(a.a.Fragment,null,a.a.createElement(k.a,{fill:!0,direction:"row"},a.a.createElement(N.a,{width:"100%",children:function(e){var t=s[e.id],r=e.get("uniqueName").split("_").filter((function(e){return e!==n}));return a.a.createElement(k.a,{pad:"small",background:u===e.objectId?"light-2":"white"},a.a.createElement(R.a,{href:"/chat/r/"+n+"/c/"+r},t))},pad:"0",primaryKey:"name",data:i})))},z=function(e){var t=e.senderRoleName,n=e.recipientRoleName,o=Object(r.useState)(null),i=o[0],c=o[1];return Object(r.useEffect)((function(){Object(C.q)([n]).then((function(e){e&&e.length&&c(e[0].rolePublicProfile)}))}),[n]),a.a.createElement(a.a.Fragment,null,a.a.createElement(x,{gap:"small",pad:"small",fill:!0,areas:[{name:"chat",start:[0,0],end:[0,0]},{name:"room",start:[1,0],end:[1,0]}],columns:["3/4","1/4"],rows:["auto"]},a.a.createElement(k.a,{fill:!0,gridArea:"room",direction:"row"},a.a.createElement(L,{senderRoleName:t,recipientRoleName:n,onActive:function(){}})),a.a.createElement(k.a,{gridArea:"chat",pad:"medium",height:"405px"},t&&a.a.createElement(S.a,{chatroomName:i&&i.get("name"),senderRoleName:t,recipientRoleName:n,publicRoom:!1}))))};t.default=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(o.Router,{basepath:"/chat"},a.a.createElement(z,{path:"/r/:senderRoleName/c/:recipientRoleName"})))}}}]);
//# sourceMappingURL=component---src-pages-chat-js-01ad899c5b4fc504f3b9.js.map